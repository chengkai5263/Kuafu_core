2023-03-17 09:14:27,840 - ensemble_learning - ERROR - 2711 - 10460 - 5500: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''51002' where '2022-01-01 00:15:00' <= forecast_time and forecast_time <= '2022-' at line 1")
Traceback (most recent call last):
  File "F:\Kuafu_20230308\task\mysql\ensemble_learning.py", line 2684, in data_load_preprocess
    train_feature, train_target = train_data_load.load_train_data_for_short_sql(
  File "F:\Kuafu_20230308\task\mysql\load_train_data.py", line 309, in load_train_data_for_short_sql
    c.execute(sql, (config["id"], start_time_datetime, middle_time_datetime, config["id"], start_time_datetime,
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''51002' where '2022-01-01 00:15:00' <= forecast_time and forecast_time <= '2022-' at line 1")
2023-03-17 09:14:30,190 - ensemble_learning - ERROR - 2711 - 19912 - 13172: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''51002' where '2022-01-01 00:15:00' <= forecast_time and forecast_time <= '2022-' at line 1")
Traceback (most recent call last):
  File "F:\Kuafu_20230308\task\mysql\ensemble_learning.py", line 2678, in data_load_preprocess
    train_feature, train_target = train_data_load.load_train_data_for_ultra_short_sql(
  File "F:\Kuafu_20230308\task\mysql\load_train_data.py", line 117, in load_train_data_for_ultra_short_sql
    c.execute(sql, (config["id"], start_time_datetime, middle_time_datetime, config["id"], start_time_datetime,
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''51002' where '2022-01-01 00:15:00' <= forecast_time and forecast_time <= '2022-' at line 1")
2023-03-17 09:14:33,656 - tools - ERROR - 57 - 20016 - 14264: save_a_fitted_model error: 
Traceback (most recent call last):
  File "F:\Kuafu_20230308\common\tools.py", line 51, in wrapper
    return func(*args, **kwargs)
  File "F:\Kuafu_20230308\app\ensemble_learning\ensemble_learning.py", line 175, in save_a_fitted_model
    fitted_model = training.fit_model(predict_term=predict_term, model_name=model_name,
  File "F:\Kuafu_20230308\common\training.py", line 69, in fit_model
    train_feature = load_model(sub_dir_path + predict_term + '_train_feature.pkl')
  File "F:\Kuafu_20230308\common\tools.py", line 31, in load_model
    model = joblib.load(filename)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\joblib\numpy_pickle.py", line 579, in load
    with open(filename, 'rb') as f:
FileNotFoundError: [Errno 2] No such file or directory: './work_dir/data/51002/short/short_train_feature.pkl'
2023-03-17 09:14:34,655 - tools - ERROR - 57 - 400 - 22696: save_a_fitted_model error: 
Traceback (most recent call last):
  File "F:\Kuafu_20230308\common\tools.py", line 51, in wrapper
    return func(*args, **kwargs)
  File "F:\Kuafu_20230308\app\ensemble_learning\ensemble_learning.py", line 175, in save_a_fitted_model
    fitted_model = training.fit_model(predict_term=predict_term, model_name=model_name,
  File "F:\Kuafu_20230308\common\training.py", line 69, in fit_model
    train_feature = load_model(sub_dir_path + predict_term + '_train_feature.pkl')
  File "F:\Kuafu_20230308\common\tools.py", line 31, in load_model
    model = joblib.load(filename)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\joblib\numpy_pickle.py", line 579, in load
    with open(filename, 'rb') as f:
FileNotFoundError: [Errno 2] No such file or directory: './work_dir/data/51002/short/short_train_feature.pkl'
2023-03-17 09:14:35,669 - tools - ERROR - 57 - 10356 - 19736: save_a_fitted_model error: 
Traceback (most recent call last):
  File "F:\Kuafu_20230308\common\tools.py", line 51, in wrapper
    return func(*args, **kwargs)
  File "F:\Kuafu_20230308\app\ensemble_learning\ensemble_learning.py", line 171, in save_a_fitted_model
    fitted_model = training.fit_model(predict_term=predict_term, model_name=model_name,
  File "F:\Kuafu_20230308\common\training.py", line 69, in fit_model
    train_feature = load_model(sub_dir_path + predict_term + '_train_feature.pkl')
  File "F:\Kuafu_20230308\common\tools.py", line 31, in load_model
    model = joblib.load(filename)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\joblib\numpy_pickle.py", line 579, in load
    with open(filename, 'rb') as f:
FileNotFoundError: [Errno 2] No such file or directory: './work_dir/data/51002/ultra_short/ultra_short_train_feature.pkl'
2023-03-17 09:14:36,681 - tools - ERROR - 57 - 16644 - 9496: save_a_fitted_model error: 
Traceback (most recent call last):
  File "F:\Kuafu_20230308\common\tools.py", line 51, in wrapper
    return func(*args, **kwargs)
  File "F:\Kuafu_20230308\app\ensemble_learning\ensemble_learning.py", line 171, in save_a_fitted_model
    fitted_model = training.fit_model(predict_term=predict_term, model_name=model_name,
  File "F:\Kuafu_20230308\common\training.py", line 69, in fit_model
    train_feature = load_model(sub_dir_path + predict_term + '_train_feature.pkl')
  File "F:\Kuafu_20230308\common\tools.py", line 31, in load_model
    model = joblib.load(filename)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\joblib\numpy_pickle.py", line 579, in load
    with open(filename, 'rb') as f:
FileNotFoundError: [Errno 2] No such file or directory: './work_dir/data/51002/ultra_short/ultra_short_train_feature.pkl'
2023-03-17 09:14:45,900 - tools - ERROR - 57 - 7076 - 17736: load_test_date_for_ensemble_learning error: 
Traceback (most recent call last):
  File "F:\Kuafu_20230308\common\tools.py", line 51, in wrapper
    return func(*args, **kwargs)
  File "F:\Kuafu_20230308\task\mysql\ensemble_learning.py", line 1761, in load_test_date_for_ensemble_learning
    c.execute(sql, (station_id, middle_time_datetime, end_time_datetime, station_id, middle_time_datetime,
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''51002' where '2022-04-01 00:00:00' <= forecast_time and forecast_time <= '2022-' at line 1")
2023-03-17 09:14:45,908 - tools - ERROR - 57 - 7076 - 17736: ensemble_learn error: 
Traceback (most recent call last):
  File "F:\Kuafu_20230308\common\tools.py", line 51, in wrapper
    return func(*args, **kwargs)
  File "F:\Kuafu_20230308\task\mysql\ensemble_learning.py", line 310, in ensemble_learn
    nwp_np_short, nwp_np_ultra_short = load_test_date_for_ensemble_learning(
TypeError: cannot unpack non-iterable NoneType object
2023-03-17 09:14:45,919 - main - ERROR - 544 - 7076 - 17736: [WinError 3] 系统找不到指定的路径。: './work_dir/data/51002'
Traceback (most recent call last):
  File "F:/Kuafu_20230308/main.py", line 540, in test_serial_tasks_feature_parameter_ensemble
    shutil.copytree(model_savepath + str(station_id),
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\shutil.py", line 555, in copytree
    with os.scandir(src) as itr:
FileNotFoundError: [WinError 3] 系统找不到指定的路径。: './work_dir/data/51002'
2023-03-17 09:26:54,754 - tools - ERROR - 57 - 20640 - 6972: load_test_date_for_ensemble_learning error: 
Traceback (most recent call last):
  File "F:\Kuafu_20230308\common\tools.py", line 51, in wrapper
    return func(*args, **kwargs)
  File "F:\Kuafu_20230308\task\mysql\ensemble_learning.py", line 1761, in load_test_date_for_ensemble_learning
    c.execute(sql, (station_id, middle_time_datetime, end_time_datetime, station_id, middle_time_datetime,
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\cursors.py", line 148, in execute
    result = self._query(query)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\cursors.py", line 310, in _query
    conn.query(q)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\connections.py", line 775, in _read_query_result
    result.read()
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''51002' where '2022-04-01 00:00:00' <= forecast_time and forecast_time <= '2022-' at line 1")
2023-03-17 09:26:54,758 - tools - ERROR - 57 - 20640 - 6972: ensemble_learn error: 
Traceback (most recent call last):
  File "F:\Kuafu_20230308\common\tools.py", line 51, in wrapper
    return func(*args, **kwargs)
  File "F:\Kuafu_20230308\task\mysql\ensemble_learning.py", line 310, in ensemble_learn
    nwp_np_short, nwp_np_ultra_short = load_test_date_for_ensemble_learning(
TypeError: cannot unpack non-iterable NoneType object
2023-03-17 09:30:22,326 - tools - ERROR - 57 - 11820 - 14812: load_test_date_for_ensemble_learning error: 
Traceback (most recent call last):
  File "F:\Kuafu_20230308\common\tools.py", line 51, in wrapper
    return func(*args, **kwargs)
  File "F:\Kuafu_20230308\task\mysql\ensemble_learning.py", line 1813, in load_test_date_for_ensemble_learning
    data_base_np = numpy.hstack((data_base.values, data_base_power.values[:, 1].reshape(-1, 1)))
  File "<__array_function__ internals>", line 180, in hstack
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\numpy\core\shape_base.py", line 345, in hstack
    return _nx.concatenate(arrs, 1)
  File "<__array_function__ internals>", line 180, in concatenate
ValueError: all the input array dimensions for the concatenation axis must match exactly, but along dimension 0, the array at index 0 has size 2808 and the array at index 1 has size 2784
2023-03-17 09:30:22,331 - tools - ERROR - 57 - 11820 - 14812: ensemble_learn error: 
Traceback (most recent call last):
  File "F:\Kuafu_20230308\common\tools.py", line 51, in wrapper
    return func(*args, **kwargs)
  File "F:\Kuafu_20230308\task\mysql\ensemble_learning.py", line 310, in ensemble_learn
    nwp_np_short, nwp_np_ultra_short = load_test_date_for_ensemble_learning(
TypeError: cannot unpack non-iterable NoneType object
2023-03-17 09:47:19,677 - tools - ERROR - 57 - 18392 - 2132: load_test_date_for_ensemble_learning error: 
Traceback (most recent call last):
  File "F:\Kuafu_20230308\common\tools.py", line 51, in wrapper
    return func(*args, **kwargs)
  File "F:\Kuafu_20230308\task\mysql\ensemble_learning.py", line 1908, in load_test_date_for_ensemble_learning
    data_base.drop(['max(start_time)', 'forecast_time', 'timelabel'], axis=1, inplace=True)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pandas\util\_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pandas\core\frame.py", line 4954, in drop
    return super().drop(
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pandas\core\generic.py", line 4267, in drop
    obj = obj._drop_axis(labels, axis, level=level, errors=errors)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pandas\core\generic.py", line 4311, in _drop_axis
    new_axis = axis.drop(labels, errors=errors)
  File "D:\Users\67436\anaconda3\envs\kuafupy38\lib\site-packages\pandas\core\indexes\base.py", line 6644, in drop
    raise KeyError(f"{list(labels[mask])} not found in axis")
KeyError: "['max(start_time)'] not found in axis"
2023-03-17 09:47:19,701 - tools - ERROR - 57 - 18392 - 2132: ensemble_learn error: 
Traceback (most recent call last):
  File "F:\Kuafu_20230308\common\tools.py", line 51, in wrapper
    return func(*args, **kwargs)
  File "F:\Kuafu_20230308\task\mysql\ensemble_learning.py", line 310, in ensemble_learn
    nwp_np_short, nwp_np_ultra_short = load_test_date_for_ensemble_learning(
TypeError: cannot unpack non-iterable NoneType object
